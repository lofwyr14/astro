<?xml version="1.0" encoding="UTF-8"?>

<ui:composition xmlns:tc="http://myfaces.apache.org/tobago/component"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns="http://www.w3.org/1999/xhtml">

  <ui:param name="title" value="Winkelberechnung"/>

  <tc:script file="#{request.contextPath}/vue-v2.5.16.js"/>
  <tc:script file="#{request.contextPath}/blog/grad/grad.js"/>
  <tc:script file="#{request.contextPath}/blog/grad/grad-vue.js"/>

  <tc:box id="box" label="Größe des Ausschnitts eines Fotos als Winkel in Grad">

    <p>
      Der Ausschnitt des Himmels <popecke-latex>\alpha</popecke-latex> der auf einem Foto erscheint ist von
      der Sensorgröße <popecke-latex>s</popecke-latex> der Kamera und der Brennweite <popecke-latex>l</popecke-latex>
      des Objektivs oder Teleskops abhängig (der Umrechnungsterm <popecke-latex>\frac{180^{\circ}}{\pi}</popecke-latex>
      wird bei Taschenrechnern in der Standardeinstellung (Grad) nicht benötigt).
    </p>
    <tc:flowLayout textAlign="center">
      <tc:figure>
        <popecke-latex display-mode="true">
          \alpha = 2 \cdot \frac{180^{\circ}}{\pi} \cdot \tan^{-1}{\frac{s}{2 \cdot l} }
        </popecke-latex>
      </tc:figure>
    </tc:flowLayout>

    <h2>
      angle width: {{angleWidth}} /
      angle height: {{angleHeight}}
    </h2>

    <p>
      Kameraauswahl:
      <tc:hidden id="cameras">
        <tc:dataAttribute name="cameras" value='{"width": #{sensorFormat.width}, "height": #{sensorFormat.height}'/>
      </tc:hidden>

      <tc:selectOneRadio id="selectSensor1" value="#{angleCalculator.cameraController.current}"
                         converter="#{angleCalculator.sensorConverter}">
        <option v-model=""/>
      </tc:selectOneRadio>
    </p>

    <tc:sheet value="#{angleCalculator.optics}" var="optic" id="sheet" markup="small">
      <tc:column label="Name">
        <tc:out value="#{optic.name}" labelLayout="skip"/>
      </tc:column>
      <tc:column label="Dynamisch">
        <tc:in value="#{optic.focalLength}" rendered="#{optic.zoom}" labelLayout="skip">
          <f:ajax render=":::sheet"/>
        </tc:in>
      </tc:column>
      <tc:column label="Brennweite">
        <tc:out value="#{optic.focalLength}" converter="focalLength" labelLayout="skip"/>
      </tc:column>
      <tc:column label="Öffnung">
        <tc:out value="#{optic.diameter}" converter="focalLength" labelLayout="skip"/>
      </tc:column>
      <tc:column label="Öffnungsverh.">
        <tc:out value="#{optic.focalRatio}" labelLayout="skip">
          <f:convertNumber maxFractionDigits="1" minFractionDigits="0"/>
        </tc:out>
      </tc:column>
      <tc:column label="Ausschnitt auf dem Sensor">
        <tc:out value="#{angleCalculator.formatSensorAngle(angleCalculator.cameraController.current, optic)}" labelLayout="skip"/>
      </tc:column>
      <tc:column label="Ausschnitt pro Pixel">
        <tc:out value="#{angleCalculator.formatPixelAngle(angleCalculator.cameraController.current, optic)}" labelLayout="skip"/>
      </tc:column>
      <tc:column label="Größe des Beugungscheibchens bei lambda = 550 nm">
        <tc:out value="#{276.0 / optic.diameter}&quot;" labelLayout="skip"/>
      </tc:column>
      <tc:column label="Auflösungsvermögen">
        <tc:out value="#{276.0 / optic.diameter}&quot;" labelLayout="skip"/>
        / <tc:out value="#{138.0 / optic.diameter}&quot;" labelLayout="skip"/>
      </tc:column>
    </tc:sheet>

  </tc:box>

  * Teilweise nicht korrekte Berechnungen, Zoom noch nicht implementiert.

</ui:composition>
