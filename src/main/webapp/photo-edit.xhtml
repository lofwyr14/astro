<?xml version="1.0" encoding="UTF-8"?>

<ui:composition xmlns:tc="http://myfaces.apache.org/tobago/component"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns="http://www.w3.org/1999/xhtml">

  <tc:box label="Fotodaten bearbeiten" id="photo-edit">
    <f:facet name="bar">
      <tc:button image="fa-plus" label="Neu">
        <f:ajax listener="#{photoController.create}" render=":page:astro"/>
      </tc:button>
    </f:facet>

    <tc:in label="ID" value="#{photoController.current.id}" readonly="#{photoController.current.revision != null}"/>
    <tc:in label="Revision" value="#{photoController.current.revision}" readonly="true"/>
    <tc:in label="Name" value="#{photoController.current.name}"/>
    <tc:date label="Startzeitpunkt" value="#{photoController.current.begin}">
      <f:convertDateTime type="both" pattern="yyyy-MM-dd HH:mm:ss"/>
    </tc:date>
    <tc:in label="Anzahl der Aufnahmen" value="#{photoController.current.exposures}"/>
    <ui:repeat value="#{photoController.current.exposures}" var="exposure">
      <tc:in tip="Anzahl" value="#{exposure.count}"/>
      <tc:in tip="Dauer [s]" value="#{exposure.duration}" converter="org.apache.myfaces.tobago.Duration"/>
      <tc:selectOneChoice tip="Filter" value="#{exposure.spectrum}">
        <tc:selectItems value="#{photoController.current.spectrumValues}" var="spectrum"
                        itemLabel="#{spectrum}" itemValue="#{spectrum}"/>
      </tc:selectOneChoice>
    </ui:repeat>
    <tc:in label="Anzahl der Darks" value="#{photoController.current.countDark}"/>
    <tc:in label="Anzahl der Bias'" value="#{photoController.current.countBias}"/>
    <tc:in label="Anzahl der Flats" value="#{photoController.current.countFlat}"/>
    <tc:in label="Optik" disabled="true" value="to be implemented"/>
    <tc:in label="Sensor" disabled="true" value="to be implemented"/>

    <tc:in label="Foto Mini" value="#{photoController.current.thumb}"/>
    <tc:in label="Foto Vorschau" value="#{photoController.current.preview}"/>
    <tc:in label="Foto Original" value="#{photoController.current.full}"/>

    <tc:textarea label="Beschreibung" value="#{photoController.current.description}"/>

    <tc:buttons>
      <tc:button label="Speichern" defaultCommand="true">
        <f:ajax listener="#{photoController.save}" render=":page:astro" execute="photo-edit"/>
      </tc:button>
      <tc:button label="Löschen" confirmation="Wirklich löschen?" markup="danger">
        <f:ajax listener="#{photoController.delete}" render=":page:astro" execute="photo-edit"/>
      </tc:button>
      <tc:button label="Abbrechen">
        <f:ajax listener="#{photoController.toList}" render=":page:astro"/>
      </tc:button>
    </tc:buttons>

  </tc:box>

</ui:composition>
